# 愛爾達收視率分析專案 - 快速使用指南 (2025年9月更新)

## 🚀 推薦執行方式（字體問題已解決）

### 1. 基礎分析（推薦新手）
```bash
# 基本收視率分析 + 圖表生成
python drama_analysis.py
python create_charts_heiti.py
```
- ✅ 無字體警告，中文顯示完美
- 📊 輸出：`ratings_analysis_heiti.png`
- 📈 終端顯示完整分析報告

### 2. 進階年齡層分析（深度分析）
```bash
# 年齡層分析 + 專業報告
python drama_age_analysis.py
python generate_pdf_report.py
```
- 🎯 年齡群體收視偏好分析
- 📑 專業PDF報告：`drama_age_analysis_report.pdf`
- � 年齡層圖表：`drama_age_analysis.png`

### 3. AI驅動的產業洞察（專業展示）
```bash
# 生成AI投影片
xelatex ai_python_presentation.tex
open ai_python_presentation.pdf
```
- 🤖 AI與Python在影視產業的應用
- 📽️ 四頁專業投影片
- 🎨 現代化設計風格

### 4. 一鍵完整分析
```bash
# 完整分析流程（15分鐘）
python drama_analysis.py && python drama_age_analysis.py && python create_charts_heiti.py && python generate_pdf_report.py
```

## 📁 主要輸出文件

### 圖表檔案
- `ratings_analysis_heiti.png` - 主要收視率分析圖表（推薦）
- `drama_age_analysis.png` - 年齡層分析圖表
- `ratings_analysis_english.png` - 英文版圖表

### 報告文件
- `drama_age_analysis_report.pdf` - 專業分析報告
- `ai_python_presentation.pdf` - AI應用投影片

### 資料檔案
- `integrated_program_ratings_cleaned.csv` - 清理後的完整資料
- `ACNelson_normalized_with_age.csv` - 含年齡層的分析資料

## 🎯 分析結果摘要

### 頂級劇集收視排名（更新）：
1. **墨雨雲間** - 平均收視率: 0.2731 (240集)
2. **延禧攻略** - 平均收視率: 0.2718 (320集)
3. **後宮甄嬛傳** - 平均收視率: 0.1928 (284集)
4. **蠟筆小新** - 平均收視率: 0.1650 (2,534集)

### 最佳時段分析：
- **20:00** - 平均收視率: 0.3847（黃金時段）
- **19:00** - 平均收視率: 0.2891
- **18:00** - 平均收視率: 0.2748

### 收視高峰紀錄：
- **墨雨雲間完結集** - 收視率: 0.8989 🏆
- **延禧攻略完結集** - 收視率: 0.8142

### 年齡層分析洞察：
- **15-24歲**: 古裝劇偏好明顯
- **25-34歲**: 主要收視群體
- **35-44歲**: 穩定收視習慣
- **45歲以上**: 傳統劇集偏好

## 🔧 程式檔案選擇指南

### 圖表生成程式
| 程式檔案 | 優點 | 適用場景 |
|---------|------|----------|
| `create_charts_heiti.py` | ✅ 推薦，中文完美 | 一般使用 |
| `create_charts_english.py` | 英文版，無字體問題 | 國際展示 |
| `create_charts_chinese_final.py` | 中文替代版 | 備選方案 |

### 分析程式
| 程式檔案 | 功能 | 執行時間 |
|---------|------|----------|
| `drama_analysis.py` | 基礎收視率分析 | ~2分鐘 |
| `drama_age_analysis.py` | 年齡層深度分析 | ~5分鐘 |
| `generate_pdf_report.py` | 專業報告生成 | ~3分鐘 |

## ⚡ 快速故障排除

### 常見問題與解決方案
1. **字體顯示問題** → 使用 `create_charts_heiti.py`
2. **PDF生成失敗** → 確認已安裝LaTeX: `brew install --cask mactex`
3. **資料載入錯誤** → 確認CSV檔案存在且完整
4. **記憶體不足** → 關閉其他應用，確保4GB+可用記憶體
5. **中文編碼問題** → 使用UTF-8編碼儲存檔案

### 系統需求檢查
```bash
# 檢查Python版本
python --version  # 需要3.7+

# 檢查關鍵套件
pip list | grep -E "(pandas|matplotlib|seaborn)"

# 檢查LaTeX安裝（PDF報告需要）
xelatex --version
```

## 📈 進階功能

### 自訂分析
```python
# 載入清理後資料進行自訂分析
import pandas as pd
df = pd.read_csv('integrated_program_ratings_cleaned.csv')

# 自訂篩選條件
high_rating = df[df['rating'] > 0.3]
weekend_data = df[df['weekday'].isin(['Saturday', 'Sunday'])]
```

### 批次處理
```bash
# 批次生成所有格式圖表
for script in create_charts_*.py; do python "$script"; done

# 批次分析（完整流程）
python drama_analysis.py && echo "基礎分析完成" && 
python drama_age_analysis.py && echo "年齡分析完成" && 
python create_charts_heiti.py && echo "圖表生成完成" && 
python generate_pdf_report.py && echo "報告生成完成"
```

## 🏆 最佳實踐建議

1. **首次使用**: 從 `drama_analysis.py` 開始
2. **展示準備**: 生成 `ai_python_presentation.pdf`
3. **深度研究**: 執行 `drama_age_analysis.py`
4. **專業報告**: 使用 `generate_pdf_report.py`
5. **定期更新**: 重新執行完整分析流程

---

**更新說明**: 本指南已更新至2025年9月版本，包含所有新增功能和改進。推薦使用最新版本獲得最佳體驗！
